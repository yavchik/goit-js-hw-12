{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport async function getImage(query, page, per_page) {\n  const params = {\n    key: '44562390-aecbf7bf64fbbf331d9c706fa',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: per_page,\n  };\n  const res = await axios.get('/api/', { params });\n  return res.data;\n}\n","import { refs } from '../main';\n\nexport function markupImages(images) {\n  const markup = images\n    .map(image => {\n      return `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n          <img\n            width=\"360\"\n            height=\"200\"\n            class=\"gallery-image\"\n            src=\"${image.webformatURL}\"\n            alt=\"${image.tags}\" />\n          <div class=\"image-info\">\n            <p>Likes ${image.likes}</p>\n            <p>Views ${image.views}</p>\n            <p>Comments ${image.comments}</p>\n            <p>Downloads ${image.downloads}</p>\n          </div>\n        </a>\n      </li>`;\n    })\n    .join('');\n  refs.imgGallery.insertAdjacentHTML('beforeend', markup);\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { getImage } from './js/pixabay-api';\nimport { markupImages } from './js/render-function';\n\nexport const refs = {\n  formEl: document.querySelector('.search-form'),\n  imgGallery: document.querySelector('.gallery'),\n  loaderEl: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.loadmore-button'),\n};\n\nlet query = '';\nlet page = 1;\nconst per_page = 15;\nlet maxPage = 1;\n\nrefs.formEl.addEventListener('submit', async e => {\n  e.preventDefault();\n  query = e.target.elements.query.value.trim();\n  if (query === '') {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please, enter the query',\n      layout: 2,\n      displayMode: 'once',\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  refs.imgGallery.innerHTML = '';\n  page = 1;\n  showLoader();\n  try {\n    const data = await getImage(query, page, per_page);\n    maxPage = Math.ceil(data.totalHits / per_page);\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        layout: 2,\n        displayMode: 'once',\n        backgroundColor: '#ef4040',\n        progressBarColor: '#B51B1B',\n        position: 'topRight',\n      });\n      hideLoadBtn();\n      return;\n    }\n    markupImages(data.hits);\n    lightbox.refresh();\n    showLoadBtn();\n    e.target.reset();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n      layout: 2,\n      displayMode: 'once',\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\nrefs.loadMoreBtn.addEventListener('click', async () => {\n  if (page >= maxPage) {\n    iziToast.error({\n      message: 'No more images to load.',\n      layout: 2,\n      displayMode: 'once',\n      backgroundColor: '#ef4040',\n      progressBarColor: '#B51B1B',\n      position: 'topRight',\n    });\n    hideLoadBtn();\n    return;\n  }\n\n  page += 1;\n  showLoader();\n  try {\n    const data = await getImage(query, page, per_page);\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, there are no more images to load.',\n        layout: 2,\n        displayMode: 'once',\n        backgroundColor: '#ef4040',\n        progressBarColor: '#B51B1B',\n        position: 'topRight',\n      });\n      hideLoadBtn();\n      return;\n    }\n    markupImages(data.hits);\n    lightbox.refresh();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n      layout: 2,\n      displayMode: 'once',\n      backgroundColor: '#ef4040',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n    skipOldEl();\n  }\n});\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction showLoader() {\n  refs.loaderEl.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  refs.loaderEl.classList.add('hidden');\n}\n\nfunction showLoadBtn() {\n  refs.loadMoreBtn.classList.remove('hidden');\n}\n\nfunction hideLoadBtn() {\n  refs.loadMoreBtn.classList.add('hidden');\n}\n\nfunction skipOldEl() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","getImage","query","page","per_page","params","markupImages","images","markup","image","refs","maxPage","e","iziToast","showLoader","data","hideLoadBtn","lightbox","showLoadBtn","hideLoader","skipOldEl","SimpleLightbox","cardHeight"],"mappings":"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"}